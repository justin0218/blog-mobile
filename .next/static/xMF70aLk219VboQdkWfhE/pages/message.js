(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{IGMo:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/message",function(){var e=a("KOn2");return{page:e.default||e}}])},KOn2:function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return O});var n=a("ln6h"),s=a.n(n),r=a("O40h"),o=a("0iUn"),i=a("sLSF"),c=a("MI3g"),l=a("a7VT"),p=a("AT/M"),u=a("Tit0"),x=a("vYYK"),d=a("MX0m"),m=a.n(d),f=a("q1tI"),g=a.n(f),b=a("CafY"),h=(a("QAIS"),a("wd/R")),j=a.n(h),w=a("00EI"),v=a("27Ns"),y=a.n(v),k=a("vDqi"),E=a.n(k),N=a("Xcx1"),O=function(e){function t(){var e,a;Object(o.default)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return a=Object(c.default)(this,(e=Object(l.default)(t)).call.apply(e,[this].concat(s))),Object(x.a)(Object(p.default)(a),"state",{blogDtail:"",detailData:{},commentsList:[],commentTotal:0,saytext:"",submitDisb:!1,submitTxt:"提交"}),a}return Object(u.default)(t,e),Object(i.default)(t,[{key:"getComments",value:function(){var e=Object(r.default)(s.a.mark(function e(){var t,a,n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.get("".concat(w.a,"/v1/blog/messageboard/list"),{responseType:"blob"});case 2:return t=e.sent,e.next=5,Object(N.a)(t.data);case 5:a=e.sent,n=(n=y.a.blogComments.deserializeBinary(a)).toObject(),console.log(n),this.setState({commentsList:n.listList,commentTotal:n.total});case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(r.default)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getComments();case 2:setTimeout(function(){document.getElementById("t").setAttribute("class","shadownone"),document.getElementById("loading").style.display="none"},500);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"subMitComment",value:function(){var e=Object(r.default)(s.a.mark(function e(t){var a,n,r,o;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=t||window.event)||13!=a.keyCode){e.next=23;break}if(""!=(n=(n=this.state.saytext).replace(/\n/g,""))){e.next=7;break}return alert("评论内容不能为空"),e.abrupt("return");case 7:return(r=new y.a.blogComment).setContent(n),r.setBlogId(0),o=r.serializeBinary(),e.prev=11,e.next=14,E.a.post("".concat(w.a,"/v1/blog/messageboard/submit"),o,{headers:{"Content-Type":"application/octet-stream"}});case 14:return e.sent,e.next=17,this.getComments();case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(11),"Error: Request failed with status code 400"==e.t0?alert("评论内容不能为空"):"Error: Request failed with status code 500"==e.t0?alert("内部出现错误"):"Error: Request failed with status code 403"==e.t0&&alert("今天您对改博客的评论已达到上限");case 22:this.setState({saytext:""});case 23:case"end":return e.stop()}},e,this,[[11,19]])}));return function(t){return e.apply(this,arguments)}}()},{key:"makeGood",value:function(){var e=Object(r.default)(s.a.mark(function e(){var t,a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.detailData,a=this.props.query.id,e.next=4,E.a.post("".concat(w.a,"/v1/blog/good/make?blog_id=").concat(a));case 4:e.sent,t.goodNum++,this.setState({detailData:t});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,a=(t.blogDtail,t.detailData,t.commentsList),n=(t.submitDisb,t.saytext),s=t.commentTotal;t.submitTxt;return g.a.createElement(b.a,{title:"留言"},g.a.createElement("div",{style:{background:"#fff"},className:"jsx-3171276270"},g.a.createElement("div",{style:{clear:"both"},className:"jsx-3171276270"}),g.a.createElement("div",{className:"jsx-3171276270 news_pl"},g.a.createElement("div",{className:"jsx-3171276270 gbko"},a.map(function(e,t){return g.a.createElement("div",{key:t,className:"jsx-3171276270 fb"},g.a.createElement("ul",{style:{background:"url(".concat(w.b[e.id%w.b.length],") no-repeat top 14px left 10px")},className:"jsx-3171276270"},g.a.createElement("span",{style:{color:"#000"},className:"jsx-3171276270"},e.name),g.a.createElement("p",{className:"jsx-3171276270 fbtime"},g.a.createElement("span",{className:"jsx-3171276270"},j()(e.createTime).format("YYYY-MM-DD"))),g.a.createElement("p",{className:"jsx-3171276270 fbinfo"},e.content)))}),g.a.createElement("div",{id:"plpost",className:"jsx-3171276270"},g.a.createElement("p",{style:0==a.length?{marginTop:8}:{},className:"jsx-3171276270 saying"},g.a.createElement("span",{className:"jsx-3171276270"},g.a.createElement("a",{href:"javascript:void(0)",style:{textDecoration:"none",color:"#de1513"},className:"jsx-3171276270"},"共有",s,"条留言")),"来说两句吧..."),g.a.createElement("textarea",{name:"saytext",value:n,onChange:function(t){e.setState({saytext:t.target.value})},rows:"6",id:"saytext",onKeyUp:this.subMitComment.bind(this),className:"jsx-3171276270"}))))),g.a.createElement(m.a,{id:"3171276270"},[".nextinfo.jsx-3171276270 a.jsx-3171276270{-webkit-text-decoration:none;text-decoration:none;color:#555;}",".nextinfo.jsx-3171276270 a.jsx-3171276270:hover{-webkit-text-decoration:underline;text-decoration:underline;color:#222;}",".yzm.jsx-3171276270{margin:10px 10px 10px 0;}","#plpost.jsx-3171276270{padding:0 10px;}",'#plpost.jsx-3171276270 input[type="submit"].jsx-3171276270{display:block;background:#303030;color:#fff;border:0;line-height:30px;padding:0 20px;border-radius:5px;float:right;margin-bottom:20px;margin-top:13px;margin-right:1%;}',"#saytext.jsx-3171276270{width:99%;outline:none;resize:none;border:solid 1px #ccc;margin-bottom:20px;}",".saying.jsx-3171276270 span.jsx-3171276270{float:right;}",".saying.jsx-3171276270{line-height:30px;color:#a9a6a6;margin-bottom:8px;}",".news_pl.jsx-3171276270 h2.jsx-3171276270{border-bottom:#000 2px solid;line-height:40px;font-size:14px;padding-left:10px;color:#000;}",".fbtime.jsx-3171276270{float:right;color:#999;font-size:12px;width:66px;overflow:hidden;white-space:nowrap;}",".fbtime.jsx-3171276270 span.jsx-3171276270{float:right;color:#999;font-size:12px;width:67px;overflow:hidden;white-space:nowrap;}","p.fbtime.jsx-3171276270{color:#000;}","p.fbinfo.jsx-3171276270{margin:10px 0;word-wrap:break-word;}",".fb.jsx-3171276270 ul.jsx-3171276270{margin:10px 10px;padding:10px 10px 10px 70px;border-bottom:#ececec 1px solid;background-size:47px 47px;}",".news_pl.jsx-3171276270{width:100%;overflow:hidden;margin:0px 0 20px 0;}",".nextinfo.jsx-3171276270{line-height:24px;width:100%;overflow:hidden;margin:20px 0;}",".nextinfo.jsx-3171276270>p.jsx-3171276270{padding:4px 10px;border-radius:5px;}",".diggit.jsx-3171276270{width:160px;margin:auto;background:#E2523A;color:#fff;box-shadow:1px 2px 6px 0px rgba(0,0,0,.2);border-radius:3px;line-height:40px;text-align:center;cursor:pointer;outline:none;display:block;}",".news_about.jsx-3171276270{color:#888888;border:1px solid #F3F3F3;padding:10px;margin:20px auto 15px auto;line-height:23px;background:none repeat 0 0 #F6F6F6;}",".bloginfo.jsx-3171276270{width:100%;overflow:hidden;}",".news_title.jsx-3171276270{font-size:24px;font-weight:normal;padding:20px 0;color:#333;margin:0;}",".bloginfo.jsx-3171276270 li.jsx-3171276270{float:left;margin-right:20px;list-style:none;}"]))}}],[{key:"getInitialProps",value:function(){var e=Object(r.default)(s.a.mark(function e(t){var a,n,r,o;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.req,n=t.query,r=t.jsonPageRes,o=a?a.headers["user-agent"]:navigator.userAgent,e.abrupt("return",{userAgent:o,query:n,jsonPageRes:r});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}]),t}(g.a.Component)}},[["IGMo",1,0]]]);